// Generated by BUCKLESCRIPT VERSION 1.7.5, PLEASE EDIT WITH CARE
'use strict';

var List     = require("bs-platform/lib/js/list.js");
var Vdom     = require("bucklescript-tea/lib/js/src/vdom.js");
var Block    = require("bs-platform/lib/js/block.js");
var Curry    = require("bs-platform/lib/js/curry.js");
var Tea_app  = require("bucklescript-tea/lib/js/src/tea_app.js");
var Tea_cmd  = require("bucklescript-tea/lib/js/src/tea_cmd.js");
var Tea_sub  = require("bucklescript-tea/lib/js/src/tea_sub.js");
var Tea_html = require("bucklescript-tea/lib/js/src/tea_html.js");
var Tea_http = require("bucklescript-tea/lib/js/src/tea_http.js");
var Tea_json = require("bucklescript-tea/lib/js/src/tea_json.js");

console.log("üòÅ ÂòªÂòª üòÅ");

function decodeConvert(output) {
  var decoder = Curry._2(Tea_json.Decoder[/* field */11], "result", Tea_json.Decoder[/* string */2]);
  return Curry._2(Tea_json.Decoder[/* decodeString */31], decoder, output);
}

function sectionInput() {
  Tea_html.styles(/* :: */[
        /* tuple */[
          "height",
          "300px"
        ],
        /* [] */0
      ]);
  return Tea_html.section(/* None */0, /* None */0, /* :: */[
              Tea_html.class$prime("section"),
              /* [] */0
            ], /* :: */[
              Tea_html.div(/* None */0, /* None */0, /* :: */[
                    Tea_html.class$prime("container"),
                    /* [] */0
                  ], /* :: */[
                    Tea_html.div(/* None */0, /* None */0, /* :: */[
                          Tea_html.class$prime("heading"),
                          /* [] */0
                        ], /* :: */[
                          Tea_html.h1(/* None */0, /* None */0, /* :: */[
                                Tea_html.class$prime("title"),
                                /* [] */0
                              ], /* :: */[
                                Tea_html.text("Missing Pieces"),
                                /* [] */0
                              ]),
                          /* :: */[
                            Tea_html.h2(/* None */0, /* None */0, /* :: */[
                                  Tea_html.class$prime("subtitle"),
                                  /* [] */0
                                ], /* :: */[
                                  Tea_html.text("For the "),
                                  /* :: */[
                                    Tea_html.strong(/* None */0, /* None */0, /* [] */0, /* :: */[
                                          Tea_html.text(" Missing Pieces "),
                                          /* [] */0
                                        ]),
                                    /* :: */[
                                      Tea_html.text("we cherish the most"),
                                      /* [] */0
                                    ]
                                  ]
                                ]),
                            /* [] */0
                          ]
                        ]),
                    /* :: */[
                      Tea_html.div(/* None */0, /* None */0, /* :: */[
                            Tea_html.class$prime("field"),
                            /* [] */0
                          ], /* :: */[
                            Tea_html.div(/* None */0, /* None */0, /* :: */[
                                  Tea_html.class$prime("card"),
                                  /* [] */0
                                ], /* :: */[
                                  Tea_html.div(/* None */0, /* None */0, /* :: */[
                                        Tea_html.class$prime("card-image"),
                                        /* [] */0
                                      ], /* :: */[
                                        Vdom.fullnode("", "figure", "", "", /* :: */[
                                              Tea_html.class$prime("image is-4by3"),
                                              /* [] */0
                                            ], /* :: */[
                                              Tea_html.img(/* None */0, /* None */0, /* :: */[
                                                    Tea_html.src("http://bulma.io/images/placeholders/1280x960.png"),
                                                    /* :: */[
                                                      Vdom.prop("alt", "Image"),
                                                      /* [] */0
                                                    ]
                                                  ], /* [] */0),
                                              /* [] */0
                                            ]),
                                        /* [] */0
                                      ]),
                                  /* :: */[
                                    Tea_html.div(/* None */0, /* None */0, /* :: */[
                                          Tea_html.class$prime("card-content"),
                                          /* [] */0
                                        ], /* :: */[
                                          Tea_html.div(/* None */0, /* None */0, /* :: */[
                                                Tea_html.class$prime("media"),
                                                /* [] */0
                                              ], /* :: */[
                                                Tea_html.div(/* None */0, /* None */0, /* :: */[
                                                      Tea_html.class$prime("media-left"),
                                                      /* [] */0
                                                    ], /* :: */[
                                                      Vdom.fullnode("", "figure", "", "", /* :: */[
                                                            Tea_html.class$prime("image is-48x48"),
                                                            /* [] */0
                                                          ], /* :: */[
                                                            Tea_html.img(/* None */0, /* None */0, /* :: */[
                                                                  Tea_html.src("http://bulma.io/images/placeholders/96x96.png"),
                                                                  /* :: */[
                                                                    Vdom.prop("alt", "Image"),
                                                                    /* [] */0
                                                                  ]
                                                                ], /* [] */0),
                                                            /* [] */0
                                                          ]),
                                                      /* [] */0
                                                    ]),
                                                /* :: */[
                                                  Tea_html.div(/* None */0, /* None */0, /* :: */[
                                                        Tea_html.class$prime("media-content"),
                                                        /* [] */0
                                                      ], /* :: */[
                                                        Tea_html.p(/* None */0, /* None */0, /* :: */[
                                                              Tea_html.class$prime("title is-4"),
                                                              /* [] */0
                                                            ], /* :: */[
                                                              Tea_html.text("Jackal"),
                                                              /* [] */0
                                                            ]),
                                                        /* :: */[
                                                          Tea_html.p(/* None */0, /* None */0, /* :: */[
                                                                Tea_html.class$prime("subtitle is-6"),
                                                                /* [] */0
                                                              ], /* :: */[
                                                                Tea_html.text("@jackal"),
                                                                /* [] */0
                                                              ]),
                                                          /* [] */0
                                                        ]
                                                      ]),
                                                  /* [] */0
                                                ]
                                              ]),
                                          /* :: */[
                                            Tea_html.div(/* None */0, /* None */0, /* :: */[
                                                  Tea_html.class$prime("content"),
                                                  /* [] */0
                                                ], /* :: */[
                                                  Tea_html.text("Elixir is a dynamic, functional language designed for building scalable and maintainable applications. Elixir leverages the Erlang VM, known for running low-latency, distributed and fault-tolerant systems, while also being successfully used in web development and the embedded software domain."),
                                                  /* :: */[
                                                    Tea_html.a(/* None */0, /* None */0, /* [] */0, /* :: */[
                                                          Tea_html.text("@Jerome"),
                                                          /* [] */0
                                                        ]),
                                                    /* :: */[
                                                      Tea_html.text("."),
                                                      /* :: */[
                                                        Tea_html.a(/* None */0, /* None */0, /* [] */0, /* :: */[
                                                              Tea_html.text("#test"),
                                                              /* [] */0
                                                            ]),
                                                        /* :: */[
                                                          Tea_html.br(/* [] */0),
                                                          /* :: */[
                                                            Vdom.fullnode("", "small", "", "", /* [] */0, /* :: */[
                                                                  Tea_html.text("11:09 PM - 1 Jan 2016"),
                                                                  /* [] */0
                                                                ]),
                                                            /* [] */0
                                                          ]
                                                        ]
                                                      ]
                                                    ]
                                                  ]
                                                ]),
                                            /* [] */0
                                          ]
                                        ]),
                                    /* [] */0
                                  ]
                                ]),
                            /* [] */0
                          ]),
                      /* :: */[
                        Tea_html.div(/* None */0, /* None */0, /* :: */[
                              Tea_html.class$prime("field is-grouped"),
                              /* [] */0
                            ], /* :: */[
                              Tea_html.p(/* None */0, /* None */0, /* :: */[
                                    Tea_html.class$prime("control"),
                                    /* [] */0
                                  ], /* :: */[
                                    Tea_html.a(/* None */0, /* None */0, /* :: */[
                                          Tea_html.class$prime("button is-primary is-outlined"),
                                          /* :: */[
                                            Tea_html.onClick(/* Convert */1),
                                            /* [] */0
                                          ]
                                        ], /* :: */[
                                          Tea_html.text("Previous"),
                                          /* [] */0
                                        ]),
                                    /* [] */0
                                  ]),
                              /* :: */[
                                Tea_html.p(/* None */0, /* None */0, /* :: */[
                                      Tea_html.class$prime("control"),
                                      /* [] */0
                                    ], /* :: */[
                                      Tea_html.a(/* None */0, /* None */0, /* :: */[
                                            Tea_html.class$prime("button is-primary is-outlined"),
                                            /* :: */[
                                              Vdom.prop("data-clipboard-target", "textarea#output"),
                                              /* [] */0
                                            ]
                                          ], /* :: */[
                                            Tea_html.text("Next"),
                                            /* [] */0
                                          ]),
                                      /* [] */0
                                    ]),
                                /* [] */0
                              ]
                            ]),
                        /* [] */0
                      ]
                    ]
                  ]),
              /* [] */0
            ]);
}

var view = sectionInput;

function init() {
  return /* tuple */[
          /* record */[
            /* html */"",
            /* ocaml */"",
            /* csrfToken : None */0
          ],
          Tea_cmd.none
        ];
}

function update(model, param) {
  if (typeof param === "number") {
    if (param) {
      var elem = document.getElementById("csrf_token");
      var cmd;
      if (elem !== null) {
        var csrfToken = elem.value;
        var encoded = Curry._1(Tea_json.Encoder[/* object_ */6], List.concat(/* :: */[
                  /* :: */[
                    /* tuple */[
                      "html",
                      Curry._1(Tea_json.Encoder[/* string */1], model[/* html */0])
                    ],
                    /* [] */0
                  ],
                  /* [] */0
                ]));
        var stringBody = Curry._2(Tea_json.Encoder[/* encode */0], 0, encoded);
        cmd = Tea_http.send((function (param) {
                if (param.tag) {
                  return /* NoOp */0;
                } else {
                  return /* ConvertDone */Block.__(2, [param[0]]);
                }
              }), Tea_http.request(/* record */[
                  /* method' */"POST",
                  /* headers : :: */[
                    /* Header */[
                      "Content-Type",
                      "application/json"
                    ],
                    /* :: */[
                      /* Header */[
                        "x-csrf-token",
                        csrfToken
                      ],
                      /* [] */0
                    ]
                  ],
                  /* url */"/convert/html/ocaml",
                  /* body : StringBody */Block.__(0, [stringBody]),
                  /* expect */Tea_http.expectString,
                  /* timeout : None */0,
                  /* withCredentials : false */0
                ]));
      } else {
        cmd = Tea_cmd.none;
      }
      return /* tuple */[
              model,
              cmd
            ];
    } else {
      return /* tuple */[
              model,
              Tea_cmd.none
            ];
    }
  } else {
    switch (param.tag | 0) {
      case 0 : 
          return /* tuple */[
                  /* record */[
                    /* html */param[0],
                    /* ocaml */model[/* ocaml */1],
                    /* csrfToken */model[/* csrfToken */2]
                  ],
                  Tea_cmd.none
                ];
      case 1 : 
          return /* tuple */[
                  /* record */[
                    /* html */model[/* html */0],
                    /* ocaml */param[0],
                    /* csrfToken */model[/* csrfToken */2]
                  ],
                  Tea_cmd.none
                ];
      case 2 : 
          var match = decodeConvert(param[0]);
          if (match.tag) {
            return /* tuple */[
                    model,
                    Tea_cmd.none
                  ];
          } else {
            return /* tuple */[
                    /* record */[
                      /* html */model[/* html */0],
                      /* ocaml */match[0],
                      /* csrfToken */model[/* csrfToken */2]
                    ],
                    Tea_cmd.none
                  ];
          }
          break;
      
    }
  }
}

function subscriptions() {
  return Tea_sub.none;
}

var partial_arg = /* record */[
  /* init */init,
  /* update */update,
  /* view */view,
  /* subscriptions */subscriptions
];

function main(param, param$1) {
  return Tea_app.standardProgram(partial_arg, param, param$1);
}

exports.decodeConvert = decodeConvert;
exports.sectionInput  = sectionInput;
exports.view          = view;
exports.init          = init;
exports.update        = update;
exports.subscriptions = subscriptions;
exports.main          = main;
/*  Not a pure module */
